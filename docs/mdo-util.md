# Utilities

The `mdo-util` command is used to help you work with and write make-do modules.

Commands generally will operate on your current working directory and should be invoked as the first positional argument to `mdo-util`.

```shell
$ mkdir ~/my-project && cd my-project/
$ mdo-util module-init
```

## `module-init`

Initializes a new module in the current directory. Ensures you have module files and most important, the include statement at the beginning of a new Makefile. If a `Makefile` already exists, it will not be overwritten and you must `include make-do.mk` in your build yourself.

## `generate-cmd`

To convert your make-do module into an installable shell command, use `mdo-util generate-cmd`.

Your command will be named for the current directory.

Note that the generated command wraps the make command and disables the [built-in rules and variables](https://www.gnu.org/software/make/manual/make.html#Catalogue-of-Rules). These are likely not needed by your custom command. 

## `generate-cmd-completions`

A starter-template for writing a bash_completion completion spec. Generated by default when you use `generate-cmd`.

You can simply find and replace `{my_cmd}` and deploy the file to `/etc/bash_completion.d/`. Naming the file for your command is a good practice. The completions file is also deployed for you by  `mdo-util install-cmd`. Note, completion scripts are only sourced on user login.

Completions will be based on a dry-run of make that will return all of the targets in your make build script. If you alter your command from the boilerplate, you might disable this functionality. Be sure to update the setting of `MAKE_TARGET_WORDS` in the completions if your command is not a wrapper for `make`.

If you have targets in your build that you want to exclude from completion suggestions, you can add pattern-matches to the black-list. Use \b before a string to match only when the whole word matches. See the manual for `sed` for more pattern matching rules.

## `install-cmd`

Executed from your make-do module directory, it will attempt to install the command executable and the bash_completions file for you.

You can override all of the defaults by setting the variables in your shell session.

- `BIN_DIR` = `/usr/local/bin` - expected to be on your `$PATH`
- `CMD_DIR` = `$(THIS_DIR)` - the directory containing the executable
- `CMD_FILE` = `$(notdir  ${CMD_DIR})` - the executable name, defaults to the directory name.

